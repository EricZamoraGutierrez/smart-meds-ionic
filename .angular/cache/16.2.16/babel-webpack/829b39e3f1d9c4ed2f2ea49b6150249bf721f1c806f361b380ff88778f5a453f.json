{"ast":null,"code":"import _asyncToGenerator from \"c:/Users/benji/OneDrive/Documents/smartmeds project/smart-meds-ionic/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\n// import { Component, OnInit } from '@angular/core';\n// import { Router } from '@angular/router';\n// import { LoginPage } from '../login/login.page';\n// import { LoginCheckService } from '../services/login-check.service';\n// import { Clipboard } from '@capacitor/clipboard';\n// import { Toast } from '@capacitor/toast';\n// import { NavController } from '@ionic/angular';\nimport { __decorate } from \"tslib\";\n// @Component({\n//   selector: 'app-tab4',\n//   templateUrl: './tab4.page.html',\n//   styleUrls: ['./tab4.page.scss'],\n// })\n// export class Tab4Page implements OnInit {\n//   constructor(private router: Router, private navCtrl: NavController, private login: LoginCheckService) { }\n//   goBack() {\n//     this.navCtrl.back();\n//   }\n//   cerrarsesion(){\n//     this.router.navigate(['/login']);\n//     this.login.setLogout();\n//   }\n//   ngOnInit() {\n//   }\n//   manual(){\n//     this.router.navigate(['/manual']);\n//   }\n//   perfil(){\n//     this.router.navigate(['/perfil']);\n//   }\n//   async copyToClipboard(text: string) {\n//     await Clipboard.write({ string: text }); \n//     this.showemailUse();\n//   }\n//   showemailUse = async () => {\n//     await Toast.show({\n//       text: 'Copiado al portapapeles',\n//     });\n//   };\n// }\nimport { Component } from '@angular/core';\nimport { getDatabase, ref } from '@angular/fire/database';\nimport { get } from 'firebase/database';\nimport { collection, query, where, getDocs } from '@angular/fire/firestore';\nlet Tab4Page = class Tab4Page {\n  toggleCard() {\n    this.expanded = !this.expanded;\n  }\n  toggleCard2() {\n    this.expanded2 = !this.expanded2;\n  }\n  toggleCard3() {\n    this.expanded3 = !this.expanded3;\n  }\n  constructor(firestore, navCtrl, notifications) {\n    this.firestore = firestore;\n    this.navCtrl = navCtrl;\n    this.notifications = notifications;\n    this.expanded = false;\n    this.expanded2 = false;\n    this.expanded3 = false;\n    this.db = getDatabase();\n    this.reference = ref(this.db, 'Peso');\n    this.stateRef = ref(this.db, 'Puerta');\n    this.weight = 0;\n    this.state = \"Cerrada\";\n    this.dataRepisaAlta = [];\n    this.dataRepisaBaja = [];\n    this.dataRepisaMedia = [];\n    // reads data from realtime database (medkit) every 2 seconds\n    this.readTask = setInterval(() => {\n      this.readKit();\n    }, 2000);\n  }\n  goBack() {\n    this.navCtrl.back();\n  }\n  ionViewDidEnter() {\n    this.readKit();\n    this.readMedicinesFromShelf('Alta');\n    this.readMedicinesFromShelf('Media');\n    this.readMedicinesFromShelf('Baja');\n    this.dataRepisaAlta = [];\n    this.dataRepisaBaja = [];\n    this.dataRepisaMedia = [];\n  }\n  // gets data from realtime database (medkit)\n  readKit() {\n    var _this = this;\n    return _asyncToGenerator(function* () {\n      yield get(_this.reference).then(snapshot => {\n        const value = snapshot.val();\n        _this.weight = value;\n      });\n      yield get(_this.stateRef).then(snapshot => {\n        const value = snapshot.val();\n        _this.state = value == 0 ? \"Cerrada\" : \"Abierta\";\n      });\n    })();\n  }\n  // notify() {\n  //   //this is a test notification\n  //   const hora = new Date().getHours()\n  //   this.notifications.scheduleTest(\"Peso en la hora: \" + hora, 1, \"Peso: \" + this.weight + \"g\")\n  // }\n  //aqui empieza el desvergue\n  readMedicinesFromShelf(shelf) {\n    var _this2 = this;\n    return _asyncToGenerator(function* () {\n      try {\n        const shelfRef = collection(_this2.firestore, 'Medicaciones');\n        const q = query(shelfRef, where('Detalles.repisa', '==', shelf));\n        const querySnapshot = yield getDocs(q);\n        querySnapshot.forEach(doc => {\n          const medicineData = doc.data();\n          switch (shelf) {\n            case 'Alta':\n              _this2.dataRepisaAlta.push(medicineData);\n              break;\n            case 'Media':\n              _this2.dataRepisaMedia.push(medicineData);\n              break;\n            case 'Baja':\n              _this2.dataRepisaBaja.push(medicineData);\n              break;\n            case \"default\":\n              break;\n          }\n        });\n      } catch (error) {\n        console.error('Error getting medicines:', error);\n      }\n    })();\n  }\n};\nTab4Page = __decorate([Component({\n  selector: 'app-tab4',\n  templateUrl: 'tab4.page.html',\n  styleUrls: ['tab4.page.scss']\n})], Tab4Page);\nexport { Tab4Page };","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}